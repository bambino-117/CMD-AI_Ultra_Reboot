<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Mégastructure // Logicateur</title>
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        html { font-size: calc(14px + 0.2vw); }
        body { margin: 0; font-family: 'Share Tech Mono', monospace; background-color: #0d0d0d; color: #00ffcc; overflow: hidden; font-size: 1rem; }
        .grime-Overlay, .moving-structure { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; }
        .grime-Overlay { background: url('/static/texture_grime.png') repeat; opacity: 0.08; z-index: 3; }
        .moving-structure { background: url('/static/structure_moving.png') center center / cover no-repeat; opacity: 0.05; animation: drift 60s infinite linear; z-index: 1; }
        @keyframes drift { 0% { transform: translate(0, 0) scale(1); } 50% { transform: translate(-1vw, 0.5vh) scale(1.05); } 100% { transform: translate(0, 0) scale(1); } }
        @keyframes glitch { 0%, 100% { text-shadow: 0.05em 0 red, -0.05em 0 blue; } 50% { text-shadow: -0.05em 0 red, 0.05em 0 blue; } }

        .chat-container {
            position: relative; z-index: 4; padding: 3vh 4vw; box-sizing: border-box;
            height: 100vh; display: flex; flex-direction: column;
        }
        h1 {
            font-size: clamp(1.5rem, 3vw, 2.5rem); margin: 0 0 1.5rem 0;
            animation: glitch 2s infinite; text-align: center;
        }
        #chat-window {
            flex-grow: 1; background: rgba(0, 10, 8, 0.4);
            border: 1px solid rgba(0, 255, 204, 0.2); border-radius: 0.25rem;
            padding: 1rem; overflow-y: auto; margin-bottom: 1rem;
            display: flex; flex-direction: column; gap: 1rem;
        }
        .message {
            padding: 0.75rem 1rem; border-radius: 0.25rem;
            max-width: 80%; line-height: 1.5;
            white-space: pre-wrap; word-wrap: break-word;
        }
        .message.user {
            background: rgba(0, 100, 80, 0.5);
            align-self: flex-end; border-left: 3px solid #00ffcc;
        }
        .message.ai {
            background: rgba(80, 0, 100, 0.5);
            align-self: flex-start; border-left: 3px solid #ff33ff;
        }
        .message.system, .message.error {
            background: rgba(100, 80, 0, 0.5);
            align-self: center; border-left: 3px solid #ffcc00;
            font-style: italic; text-align: center;
        }
        .message.error {
            background: rgba(100, 20, 0, 0.5); border-left-color: #ff5555;
        }
        .typing-indicator {
            align-self: flex-start; color: #ff33ff;
        }
        .typing-indicator span {
            animation: blink 1.4s infinite both;
        }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes blink { 0% { opacity: .2; } 20% { opacity: 1; } 100% { opacity: .2; } }

        #chat-input-form { display: flex; gap: 1rem; }
        #chat-input {
            flex-grow: 1; background: rgba(0,0,0,0.5);
            border: 1px solid rgba(0, 255, 204, 0.3); color: #00ffcc;
            font-family: inherit; font-size: 1rem; padding: 0.75rem;
            border-radius: 0.25rem;
        }
        #send-btn {
            background: #00ffcc; border: 1px solid #00ffcc; color: #0d0d0d;
            padding: 0.75rem 1.5rem; font-family: inherit; font-size: 1rem;
            cursor: pointer; border-radius: 0.25rem; transition: all 0.2s ease;
        }
        #send-btn:hover { box-shadow: 0 0 15px rgba(0, 255, 204, 0.7); }
        #send-btn:disabled { background: #555; border-color: #555; cursor: not-allowed; }

        #back-btn {
            position: fixed; bottom: 2vh; right: 2vw;
            color: rgba(0, 255, 204, 0.6); font-size: 0.8rem;
            cursor: pointer; transition: all 0.3s ease; z-index: 10;
            letter-spacing: 0.1em;
        }
        #back-btn:hover { color: #ff33ff; text-shadow: 0 0 8px #ff33ff; }
    </style>
</head>
<body>
    <div class="moving-structure"></div>
    <div class="grime-Overlay"></div>

    <div class="chat-container">
        <h1>[ NIVEAU 23 // LOGICATEUR ]</h1>
        <div id="chat-window">
            <div class="message system">Connexion au réseau de l'IA établie. Entrez votre requête.</div>
        </div>
        <form id="chat-input-form">
            <input type="text" id="chat-input" placeholder="Envoyer un message..." autocomplete="off">
            <button type="submit" id="send-btn">Envoyer</button>
        </form>
    </div>

    <div id="back-btn" onclick="window.location.href='/terminaux.html'">[ RETOUR ]</div>

    <script>
        window.addEventListener('pywebviewready', () => {
            const chatWindow = document.getElementById('chat-window');
            const inputForm = document.getElementById('chat-input-form');
            const inputField = document.getElementById('chat-input');
            const sendBtn = document.getElementById('send-btn');

            function addMessage(text, type) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${type}`;
                messageDiv.textContent = text;
                chatWindow.appendChild(messageDiv);
                chatWindow.scrollTop = chatWindow.scrollHeight;
                return messageDiv;
            }

            function showTypingIndicator() {
                const indicator = document.createElement('div');
                indicator.className = 'typing-indicator';
                indicator.innerHTML = '<span>.</span><span>.</span><span>.</span>';
                chatWindow.appendChild(indicator);
                chatWindow.scrollTop = chatWindow.scrollHeight;
                return indicator;
            }

            inputForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const prompt = inputField.value.trim();
                if (!prompt) return;

                addMessage(prompt, 'user');
                inputField.value = '';
                sendBtn.disabled = true;

                const typingIndicator = showTypingIndicator();

                try {
                    const result = await window.pywebview.api.get_ai_response(prompt);
                    typingIndicator.remove();
                    if (result.status === 'success') {
                        addMessage(result.content, 'ai');
                    } else {
                        addMessage(`Erreur de l'IA: ${result.message}`, 'error');
                    }
                } catch (err) {
                    typingIndicator.remove();
                    addMessage(`Erreur de communication: ${err}`, 'error');
                } finally {
                    sendBtn.disabled = false;
                    inputField.focus();
                }
            });

            // Vérifier si des données pré-remplies existent (depuis le Bunker par ex.)
            const prefillData = sessionStorage.getItem('logicateur_prefill');
            if (prefillData) {
                inputField.value = prefillData;
                sessionStorage.removeItem('logicateur_prefill'); // Utiliser une seule fois
                addMessage("Données d'analyse chargées depuis le Bunker. Prêt à envoyer.", 'system');
            }
        });
    </script>
</body>
</html>

```

### 2. Page du Portail Conteneur (`portail_conteneur.html`)

Cette page affichera les conteneurs disponibles et les extensions installées, permettant à l'utilisateur de les gérer.

```diff